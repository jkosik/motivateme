<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MotivateMe</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Rubik+Dirt&display=swap" rel="stylesheet">
  <script type="module" src="./app.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: #ffffff;
      color: #1a1a1a;
      min-height: 100vh;
      display: flex;
      line-height: 1.6;
      overflow: hidden;
    }

    .page-wrapper {
      display: flex;
      width: 100%;
      transition: margin-right 0.3s ease;
    }

    .page-wrapper.help-open {
      margin-right: 600px;
    }

    .main-content {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .container {
      max-width: 480px;
      width: 100%;
    }

    .help-panel {
      position: fixed;
      right: -600px;
      top: 0;
      width: 600px;
      height: 100vh;
      background: #fff;
      box-shadow: -2px 0 8px rgba(0, 0, 0, 0.1);
      overflow-y: auto;
      transition: right 0.3s ease;
      padding: 40px;
      font-size: 14px;
    }

    .help-panel.open {
      right: 0;
    }

    .help-close {
      position: absolute;
      top: 20px;
      right: 20px;
      font-size: 28px;
      font-weight: 300;
      color: #666;
      cursor: pointer;
      background: none !important;
      border: none;
      padding: 0;
      width: auto;
      height: auto;
      line-height: normal;
      text-align: center;
      outline: none;
      box-shadow: none;
      transition: none;
    }

    .help-close:hover,
    .help-close:focus,
    .help-close:active {
      background: none !important;
      color: #666;
      outline: none;
      box-shadow: none;
      transform: none;
    }

    .help-panel h3 {
      font-size: 18px;
      margin-top: 24px;
      margin-bottom: 12px;
      color: #000;
    }

    .help-panel h3:first-of-type {
      margin-top: 0;
    }

    .help-panel p {
      margin-bottom: 12px;
      line-height: 1.6;
      color: #333;
    }

    .help-panel ul {
      margin: 12px 0;
      padding-left: 24px;
    }

    .help-panel li {
      margin-bottom: 8px;
      line-height: 1.6;
      color: #333;
    }

    .logo {
      width: 180px;
      height: auto;
      margin: 0 auto 24px auto;
      display: block;
    }

    h1 {
      font-family: 'Rubik Dirt', cursive;
      font-size: 42px;
      font-weight: 400;
      margin-bottom: 16px;
      color: #000;
      letter-spacing: -0.5px;
      text-align: center;
    }

    .help-link {
      text-align: center;
      margin-bottom: 32px;
    }

    .help-link a {
      color: #666;
      text-decoration: none;
      font-size: 14px;
      cursor: pointer;
      transition: color 0.15s ease;
    }

    .help-link a:hover {
      color: #000;
    }

    .section {
      margin-bottom: 32px;
    }

    .row {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 8px;
    }

    .info {
      color: #6b7280;
      font-size: 14px;
      flex: 1;
    }

    .info.connected {
      color: #10b981;
      font-weight: 500;
    }

    button {
      background: #000;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 12px 24px;
      font-size: 15px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s ease;
      min-width: 140px;
    }

    button:hover {
      background: #333;
    }

    button:active {
      transform: scale(0.98);
    }

    button:disabled {
      background: #e5e7eb;
      color: #9ca3af;
      cursor: not-allowed;
    }

    select {
      background: #fff;
      color: #1a1a1a;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 12px 16px;
      font-size: 15px;
      cursor: pointer;
      transition: all 0.15s ease;
      min-width: 140px;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%231a1a1a' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
      padding-right: 36px;
    }

    select:hover {
      border-color: #9ca3af;
    }

    select:focus {
      outline: none;
      border-color: #000;
    }

    input[type="number"],
    input[type="text"] {
      background: #fff;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 12px 16px;
      font-size: 15px;
      transition: all 0.15s ease;
      width: 100%;
      margin-bottom: 12px;
    }

    input[type="number"]:focus,
    input[type="text"]:focus {
      outline: none;
      border-color: #000;
    }

    .contract-info {
      margin-top: 48px;
      padding-top: 24px;
      border-top: 1px solid #e5e7eb;
      font-size: 13px;
      color: #9ca3af;
    }

    .contract-address {
      font-family: 'Courier New', monospace;
      word-break: break-all;
      margin-top: 4px;
      color: #667eea;
      text-decoration: none;
      transition: color 0.15s ease;
    }

    .contract-address:hover {
      color: #5568d3;
      text-decoration: underline;
    }

    .hidden {
      display: none;
    }

    @media (max-width: 640px) {
      h1 {
        font-size: 28px;
      }
      .row {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }
      button, select {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="page-wrapper" id="pageWrapper">
    <div class="main-content">
      <div class="container">
        <img src="./logo.png" alt="MotivateMe Logo" class="logo">
        <h1>MotivateMe</h1>
        <div class="help-link">
          <a onclick="document.getElementById('pageWrapper').classList.add('help-open'); document.getElementById('helpPanel').classList.add('open')">Help‚ùì</a>
        </div>

        <div class="section">
          <div class="row">
            <button id="connectBtn">Connect wallet</button>
            <div class="info" id="walletInfo">Not connected</div>
          </div>
        </div>

        <div class="section hidden" id="actionsSection">
          <div class="row">
            <input type="text" id="recipientInput" placeholder="Recipient's address (0x...)" />
          </div>
          <div class="row">
            <select id="functionSelect">
              <option value="">Select Motivation</option>
              <option value="read">Read counter</option>
              <option value="increment">Increment +1</option>
              <option value="set">Set value</option>
            </select>
            <div class="info" id="functionInfo">‚Äî</div>
          </div>
          <div id="setValueInput" class="hidden">
            <input type="number" id="valueInput" placeholder="Enter value" />
          </div>
        </div>

        <div class="contract-info">
          <div>Contract address</div>
          <a id="contractAddr" class="contract-address" href="#" target="_blank" rel="noopener noreferrer"></a>
          <div id="walletBalance" class="hidden" style="margin-top: 8px;">
            <div style="font-size: 12px; color: #8c8c8c;">Wallet balance of native ETH (full precision)</div>
            <div id="balanceAmount" class="contract-address">‚Äî</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Help Panel -->
  <div id="helpPanel" class="help-panel">
    <button class="help-close" onclick="document.getElementById('pageWrapper').classList.remove('help-open'); document.getElementById('helpPanel').classList.remove('open')">&times;</button>

    <h3>ü¶• What is <span style="font-family: 'Rubik Dirt', cursive;">MotivateMe</span>?</h3>
    <p>MotivateMe is a blockchain dApp (decentralized application) where you can challenge yourself or others by locking cryptocurrency as motivation.
      Money are released to the recipient only after the challenge is completed. Completion is defined in the Smart Contract.
      All transactions happen on the <strong><a href="https://inkonchain.com/" target="_blank">Ink network</a></strong>.</p>

    <h3>üí∞ Requirements for Challenger (locks money for the recipient)</h3>
    <ul>
      <li>EVM-compatible wallet (MetaMask, Kraken Wallet, etc.) as browser extension or mobile app.</li>
      <li><strong>Small fraction of ETH on Ink network</strong> in the wallet to pay for gas fees - equivalent of USD subcents is enough.</li>
      <li>To fund ETH to Ink network, you can use <a href="https://inkonchain.com/bridge" target="_blank">https://inkonchain.com/bridge</a> or any other bridge.</li>
    </ul>

    <h3>üéØ Requirements for Challenged (recipient of the money)</h3>
    <ul>
      <li>Ethereum-compatible address (0x...) generated by EVM-compatible wallet.</li>
      <li>To see the received funds, recipient must add Ink network to the wallet.</li>
      <li>Using Kraken wallet, funds can be easily transferred to Kraken exchange for further use or withdrawal.</li>
    </ul>

    <h3>‚ö†Ô∏è Important Notes</h3>
    <ul>
      <li>All transactions happen <strong>only on Ink network</strong>.</li>
      <li>Gas fees are paid in ETH on Ink network.</li>
    </ul>
  </div>

  <script type="module">
    // ---- CONFIG ----
    // Testnet Configuration (Ink Sepolia)
    const INK_SEPOLIA = {
      chainId: '0xba5ed',                     // 763373 in hex
      chainIdDecimal: 763373,
      chainName: 'Ink Sepolia',
      nativeCurrency: { name: 'Ether', symbol: 'ETH', decimals: 18 },
      rpcUrls: ['https://rpc-gel-sepolia.inkonchain.com'],
      blockExplorerUrls: ['https://explorer-sepolia.inkonchain.com']
    };

    // Mainnet Configuration (Ink)
    const INK_MAINNET = {
      chainId: '0xdf11',                      // 57073 in hex
      chainIdDecimal: 57073,
      chainName: 'Ink',
      nativeCurrency: { name: 'Ether', symbol: 'ETH', decimals: 18 },
      rpcUrls: ['https://rpc-gel.inkonchain.com'],
      blockExplorerUrls: ['https://explorer.inkonchain.com']
    };

    // Select to INK_MAINNET or INK_SEPOLIA. Testnet looks like not supported by Kraken Wallet for write operations.
    // const ACTIVE_NETWORK = INK_SEPOLIA;
    const ACTIVE_NETWORK = INK_MAINNET;

    // Address is based on nonce (transaction count) and Deployer address. If we use fresh new wallet, nonce is 0
    // and the address is the same on Testnet and Mainnet.
    const CONTRACT_ADDRESS = '0x4fcC5C461B59ECC4786CDa6Ec270bA29Eb657FAF';

    // WalletConnect v2 Project ID from https://dashboard.reown.com
    const WALLETCONNECT_PROJECT_ID = 'd608436759f83467578a0fda722d7542';

    // Minimal ABI for Counter
    const ABI = [
      { "inputs": [], "name": "increment", "outputs": [], "stateMutability": "nonpayable", "type": "function" },
      { "inputs": [ { "internalType": "uint256", "name": "newNumber", "type": "uint256" } ],
        "name": "setNumber", "outputs": [], "stateMutability": "nonpayable", "type": "function" },
      { "inputs": [], "name": "number", "outputs": [ { "internalType": "uint256", "name": "", "type": "uint256" } ],
        "stateMutability": "view", "type": "function" }
    ];

    // Initialize the app with configuration
    window.addEventListener('DOMContentLoaded', () => {
      if (window.initializeApp) {
        window.initializeApp({
          ACTIVE_NETWORK,
          CONTRACT_ADDRESS,
          ABI,
          WALLETCONNECT_PROJECT_ID
        });
      }
    });
  </script>
</body>
</html>
